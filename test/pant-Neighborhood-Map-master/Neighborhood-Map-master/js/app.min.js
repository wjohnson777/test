"use strict";function MapViewModel(){function c(d){function i(a){var b=new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+a+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34));return b}var e=this;e.title=d.title,e.latitude=d.location.lat,e.longitude=d.location.lng,e.distance=d.distance,e.fourSquareVenueId=d.fsVenueId,e.fourSquareContent=null;var f="https://api.foursquare.com/v2/venues/"+e.fourSquareVenueId+"?&client_id=PUG4F3ZBQON10GMS2DNSFKTTPREXDREPPDMMHOEWIFUW2DG1&client_secret=NJJCQJT52QU5BXQU4SPJGWY2M5BBJMYBSU1JHAKZFDMBNA1G&v=20161219",g=i("e74c3c"),h=i("f1c40f");e.trailMarker=new google.maps.Marker({title:e.title,position:{lat:e.latitude,lng:e.longitude},map:map,icon:g}),e.trailMarker.addListener("mouseover",function(){this.setIcon(h)}),e.trailMarker.addListener("mouseout",function(){this.setIcon(g)}),null===c.prototype.markerAnim,e.panToLoc=function(){map.panTo({lat:e.latitude,lng:e.longitude})},e.trailMarker.addListener("click",function(){e.panToLoc(),e.populateInfoWindow(e.trailMarker,a)}),e.populateInfoWindow=function(a,c){if(c.marker!=a){c.marker=a,b&&b!=a&&b.setAnimation(null),a.setAnimation(google.maps.Animation.BOUNCE),b=a;var d='<h2 class="trail-title">'+e.title+'</h2><p class="trail-distance">Distance: '+e.distance+"</p>";if(c.setContent(d),!e.fourSquareContent){var g=c.getContent(),h=g+'<div id="foursquarePhotos"><h3>Loading photos...</h3></div>';c.setContent(h),$.ajax({url:f,dataType:"json",success:function(a){c.setContent(g);var b=g+'<div id="foursquarePhotos">';b+="<p>FourSquare Photos</p>";for(var d=a.response.venue.photos.groups[0].items,e=a.response.venue.canonicalUrl,f=0;f<4;f++)b+='<div class="fsphoto"><a target="_blank" href="'+e+'"><img src="'+d[f].prefix+"40x40"+d[f].suffix+'"></a></div>';b+="</div>",c.setContent(b)},error:function(){var a="<h3>Error loading FourSquare data : Failed!</h3>";c.setContent(a)}})}c.addListener("closeclick",function(){c.marker=null,a.setAnimation(null)}),c.open(map,a)}}}function e(a){for(var b,e=[],f=new google.maps.LatLngBounds,g=0;g<a.length;g++)b=new c(a[g]),e.push(b),f.extend(b.trailMarker.position);d.trails(e),map.fitBounds(f),google.maps.event.addDomListener(window,"resize",function(){map.fitBounds(f)})}var a=new google.maps.InfoWindow,b=null,d=this;d.trails=ko.observableArray([]),d.searchFilter=ko.observable(""),d.isVisible=ko.observable(!1),d.searchResults=ko.computed(function(){for(var b=[],c=new RegExp(d.searchFilter(),"i"),e=0;e<d.trails().length;e++)d.trails()[e].title.search(c)!==-1?(b.push(d.trails()[e]),d.trails()[e].trailMarker.setVisible(!0),d.trails()[e].panToLoc()):(d.trails()[e].trailMarker.setVisible(!1),a.close());return b}),e(locationsData),d.onClick=function(b){b.panToLoc(),b.populateInfoWindow(b.trailMarker,a),window.innerWidth<1024&&d.isVisible(!1)},d.toggleDisplay=function(){d.isVisible(!d.isVisible())}}function initMap(){var a={lat:32.7157,lng:-117.1611};map=new google.maps.Map(document.getElementById("map"),{zoom:14,center:a,mapTypeControl:!1}),ko.applyBindings(new MapViewModel)}function errorOnLoad(){alert("Loading Google Maps API : Failed!")}var map;